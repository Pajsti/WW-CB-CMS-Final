---
import Layout from '../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const articles = (await getCollection('news')).sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf()
);

const fmtDate = (d: Date) => d.toLocaleDateString('cs-CZ', { year: 'numeric', month: 'short', day: 'numeric' });
---

<Layout title="Aktuality — WW-CB">
  <h2 class="section-title">Aktuality</h2>
  <div class="article-list">
    {articles.map(article => (
      <article class="article-row">
        <a href={`/article/${article.slug}`} style="display:flex;gap:16px;text-decoration:none;color:inherit;width:100%;">
          <div class="art-thumb">
            <img src={article.data.image} alt={article.data.title}>
          </div>
          <div class="art-body">
            <div class="art-meta">
              <div style="min-width:0"><h3 class="art-title">{article.data.title}</h3></div>
              <div class="date-pill">{fmtDate(article.data.date)}</div>
            </div>
            <p class="art-excerpt">{article.data.excerpt}</p>
            <div class="art-actions">
              <div style="margin-left:auto"></div>
              <div class="muted" style="color:var(--muted);font-size:13px">Číst dál →</div>
            </div>
          </div>
        </a>
      </article>
    ))}
    {articles.length === 0 && <div class="empty">Žádné články.</div>}
  </div>
</Layout>
